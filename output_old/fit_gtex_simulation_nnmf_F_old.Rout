## note: there is probably some issue with initialization. I will initialize using results from `rnmf` next


Loading GTEx simulation data.
Loaded 11688 x 55863 count matrix.
Fitting Poisson topic model using nnmf.

 Iteration |        MSE |        MKL |     Target |  Rel. Err.
--------------------------------------------------------------
         1 | 124635590.5688 |   343.2444 | 62317795.2844 |          2
         2 | 11544261.7086 |   133.8127 | 5772130.8543 |          2
         3 | 7703144.8737 |    90.1310 | 3851572.4368 |        0.4
         4 | 7011563.6680 |    79.9979 | 3505781.8340 |       0.09
         5 | 6471788.9518 |    77.2302 | 3235894.4759 |       0.08
         6 | 5226112.3369 |    72.5138 | 2613056.1685 |        0.2
         7 | 2976157.9963 |    60.2420 | 1488078.9981 |        0.5
         8 | 1983304.8785 |    51.4878 | 991652.4393 |        0.4
         9 | 1667667.4202 |    46.3202 | 833833.7101 |        0.2
        10 | 1535188.1990 |    43.5744 | 767594.0995 |       0.08
        11 | 1431572.1947 |    41.0993 | 715786.0974 |       0.07
        12 | 1343084.4695 |    38.6164 | 671542.2348 |       0.06
        13 | 1278325.3060 |    37.0830 | 639162.6530 |       0.05
        14 | 1225212.2730 |    35.9936 | 612606.1365 |       0.04
        15 | 1175333.5386 |    35.3976 | 587666.7693 |       0.04
        16 | 1122750.2683 |    35.6650 | 561375.1342 |       0.05
        17 | 1065085.6612 |    35.9782 | 532542.8306 |       0.05
        18 | 1002249.8340 |    36.5597 | 501124.9170 |       0.06
        19 | 942347.3365 |    37.0803 | 471173.6683 |       0.06
        20 | 896564.6914 |    36.9423 | 448282.3457 |       0.05
        21 | 865846.0572 |    36.4972 | 432923.0286 |       0.03
        22 | 843829.0469 |    35.9654 | 421914.5234 |       0.03
        23 | 826577.9002 |    35.4298 | 413288.9501 |       0.02
        24 | 811700.8885 |    35.0052 | 405850.4443 |       0.02
        25 | 798285.6501 |    34.6490 | 399142.8250 |       0.02
        26 | 785885.4899 |    34.3619 | 392942.7449 |       0.02
        27 | 773916.5330 |    34.2110 | 386958.2665 |       0.02
        28 | 761874.5614 |    34.2294 | 380937.2807 |       0.02
        29 | 749351.8499 |    34.3972 | 374675.9250 |       0.02
        30 | 735926.0315 |    34.3867 | 367963.0157 |       0.02
        31 | 721359.1579 |    34.1723 | 360679.5790 |       0.02
        32 | 705759.7503 |    33.8143 | 352879.8751 |       0.02
        33 | 689793.8115 |    33.4355 | 344896.9057 |       0.02
        34 | 674536.2713 |    33.1466 | 337268.1357 |       0.02
        35 | 660496.1572 |    32.7849 | 330248.0786 |       0.02
        36 | 647874.6359 |    32.4289 | 323937.3179 |       0.02
        37 | 636487.8053 |    32.0545 | 318243.9026 |       0.02
        38 | 625774.2250 |    31.6309 | 312887.1125 |       0.02
        39 | 615165.8707 |    31.1458 | 307582.9354 |       0.02
        40 | 604205.4759 |    30.6073 | 302102.7380 |       0.02
        41 | 592600.9727 |    30.0860 | 296300.4864 |       0.02
        42 | 580261.8649 |    29.6494 | 290130.9325 |       0.02
        43 | 567270.0575 |    29.2852 | 283635.0288 |       0.02
        44 | 553983.2327 |    28.6594 | 276991.6164 |       0.02
        45 | 540928.0613 |    28.0358 | 270464.0306 |       0.02
        46 | 528432.1655 |    27.3845 | 264216.0828 |       0.02
        47 | 516643.2511 |    26.6996 | 258321.6256 |       0.02
        48 | 505700.6623 |    26.0150 | 252850.3311 |       0.02
        49 | 495733.3713 |    25.3447 | 247866.6857 |       0.02
        50 | 486819.2465 |    24.6801 | 243409.6232 |       0.02
        51 | 478941.0944 |    24.0462 | 239470.5472 |       0.02
        52 | 472093.2460 |    23.7281 | 236046.6230 |       0.01
        53 | 466381.7385 |    23.3668 | 233190.8693 |       0.01
        54 | 461577.3298 |    22.9231 | 230788.6649 |       0.01
        55 | 457510.0968 |    22.5051 | 228755.0484 |      0.009
        56 | 454043.1764 |    22.1017 | 227021.5882 |      0.008
        57 | 451087.2120 |    21.7321 | 225543.6060 |      0.007
        58 | 448570.4542 |    21.3759 | 224285.2271 |      0.006
        59 | 446431.6368 |    21.0650 | 223215.8184 |      0.005
        60 | 444617.0533 |    20.8335 | 222308.5266 |      0.004
        61 | 443070.6441 |    20.6469 | 221535.3220 |      0.003
        62 | 441735.6187 |    20.4894 | 220867.8094 |      0.003
        63 | 440565.2618 |    20.2792 | 220282.6309 |      0.003
        64 | 439532.0587 |    20.1169 | 219766.0294 |      0.002
        65 | 438614.0635 |    19.8662 | 219307.0317 |      0.002
        66 | 437793.0100 |    19.7406 | 218896.5050 |      0.002
        67 | 437053.7473 |    19.6675 | 218526.8736 |      0.002
        68 | 436383.7163 |    19.6008 | 218191.8581 |      0.002
        69 | 435773.3651 |    19.5847 | 217886.6825 |      0.001
        70 | 435217.0008 |    19.5487 | 217608.5004 |      0.001
        71 | 434709.6692 |    19.5175 | 217354.8346 |      0.001
        72 | 434244.4691 |    19.5033 | 217122.2345 |      0.001
        73 | 433818.1774 |    19.4948 | 216909.0887 |      0.001
        74 | 433425.6322 |    19.4817 | 216712.8161 |     0.0009
        75 | 433062.5413 |    19.4712 | 216531.2707 |     0.0008
        76 | 432727.9642 |    19.4364 | 216363.9821 |     0.0008
        77 | 432418.8555 |    19.4607 | 216209.4278 |     0.0007
        78 | 432129.7115 |    19.4630 | 216064.8558 |     0.0007
        79 | 431857.6932 |    19.4663 | 215928.8466 |     0.0006
        80 | 431600.4087 |    19.4119 | 215800.2043 |     0.0006
        81 | 431355.8720 |    19.3914 | 215677.9360 |     0.0006
        82 | 431122.6361 |    19.3893 | 215561.3180 |     0.0005
        83 | 430899.0910 |    19.3911 | 215449.5455 |     0.0005
        84 | 430683.9005 |    19.3956 | 215341.9503 |     0.0005
        85 | 430476.1807 |    19.3941 | 215238.0904 |     0.0005
        86 | 430275.0795 |    19.4030 | 215137.5398 |     0.0005
        87 | 430080.0222 |    19.4017 | 215040.0111 |     0.0005
        88 | 429891.0017 |    19.4066 | 214945.5008 |     0.0004
        89 | 429707.9211 |    19.4090 | 214853.9606 |     0.0004
        90 | 429529.3651 |    19.4101 | 214764.6825 |     0.0004
        91 | 429354.9509 |    19.4144 | 214677.4755 |     0.0004
        92 | 429184.3625 |    19.4187 | 214592.1813 |     0.0004
        93 | 429017.2094 |    19.4217 | 214508.6047 |     0.0004
        94 | 428853.1365 |    19.4509 | 214426.5683 |     0.0004
        95 | 428691.7724 |    19.4230 | 214345.8862 |     0.0004
        96 | 428532.8715 |    19.4211 | 214266.4358 |     0.0004
        97 | 428378.6540 |    19.4236 | 214189.3270 |     0.0004
        98 | 428237.6453 |    19.4291 | 214118.8227 |     0.0003
        99 | 428105.7808 |    19.4339 | 214052.8904 |     0.0003
       100 | 427978.1424 |    19.4384 | 213989.0712 |     0.0003
       101 | 427852.9712 |    19.4400 | 213926.4856 |     0.0003
       102 | 427729.5742 |    19.4434 | 213864.7871 |     0.0003
       103 | 427607.6007 |    19.4458 | 213803.8003 |     0.0003
       104 | 427486.8690 |    19.4445 | 213743.4345 |     0.0003
       105 | 427367.7309 |    19.4468 | 213683.8654 |     0.0003
       106 | 427250.4189 |    19.4514 | 213625.2095 |     0.0003
       107 | 427134.0782 |    19.4510 | 213567.0391 |     0.0003
       108 | 427018.5293 |    19.4544 | 213509.2646 |     0.0003
       109 | 426903.7085 |    19.4554 | 213451.8542 |     0.0003
       110 | 426789.5475 |    19.4586 | 213394.7738 |     0.0003
       111 | 426675.9921 |    19.4540 | 213337.9960 |     0.0003
       112 | 426562.9499 |    19.4551 | 213281.4749 |     0.0003
       113 | 426450.3384 |    19.4603 | 213225.1692 |     0.0003
       114 | 426338.1070 |    19.4612 | 213169.0535 |     0.0003
       115 | 426226.1007 |    19.4676 | 213113.0504 |     0.0003
       116 | 426114.1905 |    19.4677 | 213057.0952 |     0.0003
       117 | 426002.3203 |    19.4698 | 213001.1601 |     0.0003
       118 | 425890.4487 |    19.4732 | 212945.2244 |     0.0003
       119 | 425778.5491 |    19.4769 | 212889.2745 |     0.0003
       120 | 425666.5912 |    19.5044 | 212833.2956 |     0.0003
       121 | 425554.5513 |    19.5063 | 212777.2756 |     0.0003
       122 | 425442.3872 |    19.5059 | 212721.1936 |     0.0003
       123 | 425330.0601 |    19.5104 | 212665.0300 |     0.0003
       124 | 425217.5289 |    19.5113 | 212608.7645 |     0.0003
       125 | 425104.7570 |    19.5129 | 212552.3785 |     0.0003
       126 | 424991.7087 |    19.5148 | 212495.8543 |     0.0003
       127 | 424878.3644 |    19.5167 | 212439.1822 |     0.0003
       128 | 424764.6770 |    19.5199 | 212382.3385 |     0.0003
       129 | 424650.5987 |    19.5235 | 212325.2994 |     0.0003
       130 | 424536.0849 |    19.5265 | 212268.0425 |     0.0003
       131 | 424421.1051 |    19.5413 | 212210.5525 |     0.0003
       132 | 424305.6017 |    19.5458 | 212152.8008 |     0.0003
       133 | 424189.5256 |    19.5495 | 212094.7628 |     0.0003
       134 | 424072.8359 |    19.5549 | 212036.4180 |     0.0003
       135 | 423955.4333 |    19.5594 | 211977.7166 |     0.0003
       136 | 423837.2465 |    19.5647 | 211918.6233 |     0.0003
       137 | 423718.2598 |    19.5759 | 211859.1299 |     0.0003
       138 | 423598.4500 |    19.5890 | 211799.2250 |     0.0003
       139 | 423477.6945 |    19.5925 | 211738.8472 |     0.0003
       140 | 423357.3725 |    19.5969 | 211678.6863 |     0.0003
       141 | 423236.2712 |    19.6042 | 211618.1356 |     0.0003
       142 | 423114.0251 |    19.5911 | 211557.0125 |     0.0003
       143 | 422990.5359 |    19.5748 | 211495.2680 |     0.0003
       144 | 422865.6418 |    19.5629 | 211432.8209 |     0.0003
       145 | 422739.1335 |    19.5688 | 211369.5668 |     0.0003
       146 | 422610.9301 |    19.5756 | 211305.4650 |     0.0003
       147 | 422480.1023 |    19.5763 | 211240.0511 |     0.0003
       148 | 422347.1837 |    19.5871 | 211173.5918 |     0.0003
       149 | 422212.1198 |    19.5881 | 211106.0599 |     0.0003
       150 | 422074.6036 |    19.5932 | 211037.3018 |     0.0003
       151 | 421934.3144 |    19.6020 | 210967.1572 |     0.0003
       152 | 421790.8680 |    19.6082 | 210895.4340 |     0.0003
       153 | 421643.6782 |    19.6406 | 210821.8391 |     0.0003
       154 | 421492.0400 |    19.6951 | 210746.0200 |     0.0004
       155 | 421335.0487 |    19.7173 | 210667.5244 |     0.0004
       156 | 421171.5441 |    19.7280 | 210585.7721 |     0.0004
       157 | 420999.7177 |    19.7411 | 210499.8588 |     0.0004
       158 | 420817.1550 |    19.7540 | 210408.5775 |     0.0004
       159 | 420622.0724 |    19.7759 | 210311.0362 |     0.0005
       160 | 420414.5833 |    19.7880 | 210207.2917 |     0.0005
       161 | 420191.8593 |    19.7576 | 210095.9297 |     0.0005
       162 | 419948.9750 |    19.7763 | 209974.4875 |     0.0006
       163 | 419679.7624 |    19.6687 | 209839.8812 |     0.0006
       164 | 419374.6775 |    19.5724 | 209687.3387 |     0.0007
       165 | 419019.8891 |    19.5117 | 209509.9446 |     0.0008
       166 | 418595.8850 |    19.4956 | 209297.9425 |      0.001
       167 | 418078.8791 |    19.5090 | 209039.4396 |      0.001
       168 | 417442.4312 |    19.5136 | 208721.2156 |      0.002
       169 | 416843.8285 |    19.4744 | 208421.9143 |      0.001
       170 | 416267.8981 |    19.4814 | 208133.9490 |      0.001
       171 | 415658.1821 |    19.4510 | 207829.0910 |      0.001
       172 | 414975.2773 |    19.4556 | 207487.6386 |      0.002
       173 | 414149.4695 |    19.4598 | 207074.7347 |      0.002
       174 | 413124.1935 |    19.4599 | 206562.0968 |      0.002
       175 | 411681.5245 |    19.4482 | 205840.7622 |      0.003
       176 | 409369.2537 |    19.4732 | 204684.6269 |      0.006
       177 | 405118.7870 |    19.4005 | 202559.3935 |       0.01
       178 | 396281.7782 |    19.3132 | 198140.8891 |       0.02
       179 | 378533.7613 |    19.0131 | 189266.8807 |       0.05
       180 | 349781.6569 |    18.5701 | 174890.8285 |       0.08
       181 | 311694.1257 |    17.7281 | 155847.0629 |        0.1
       182 | 273967.9319 |    16.4581 | 136983.9660 |        0.1
       183 | 239567.2376 |    14.8911 | 119783.6188 |        0.1
       184 | 215475.8684 |    13.4158 | 107737.9342 |        0.1
       185 | 202244.5314 |    12.3917 | 101122.2657 |       0.06
       186 | 194858.8001 |    11.8139 | 97429.4000 |       0.04
       187 | 190223.4536 |    11.4926 | 95111.7268 |       0.02
       188 | 187001.7999 |    11.3410 | 93500.8999 |       0.02
       189 | 184598.6500 |    11.2294 | 92299.3250 |       0.01
       190 | 182783.4190 |    11.1395 | 91391.7095 |       0.01
       191 | 181400.5286 |    11.0797 | 90700.2643 |      0.008
       192 | 180329.8474 |    11.0391 | 90164.9237 |      0.006
       193 | 179490.1273 |    11.0178 | 89745.0636 |      0.005
       194 | 178816.6264 |    11.0113 | 89408.3132 |      0.004
       195 | 178254.8180 |    11.0068 | 89127.4090 |      0.003
       196 | 177769.1542 |    11.0048 | 88884.5771 |      0.003
       197 | 177342.4951 |    11.0090 | 88671.2475 |      0.002
       198 | 176964.5943 |    11.0180 | 88482.2971 |      0.002
       199 | 176624.2691 |    11.0297 | 88312.1345 |      0.002
       200 | 176312.7972 |    11.0432 | 88156.3986 |      0.002
--------------------------------------------------------------
 Iteration |        MSE |        MKL |     Target |  Rel. Err.

Warning message:
In system.time(out <- .Call("NNLM_nnmf", A, as.integer(k), init.mask$Wi,  :
  Target tolerance not reached. Try a larger max.iter.
Computation took 7494.93 seconds.
Compute loglikelihood and mse
method type: poisson
 
	poisson_ll :-Inf
 
	multinom_ll:-5541676793230.655273437500

	mse        :176312.797215957195
Writing results to file.
Session info:
R version 3.5.1 (2018-07-02)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Scientific Linux 7.4 (Nitrogen)

Matrix products: default
BLAS/LAPACK: /software/openblas-0.2.19-el7-x86_64/lib/libopenblas_haswellp-r0.2.19.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] NNLM_0.4.2  readr_1.3.1

loaded via a namespace (and not attached):
 [1] compiler_3.5.1   R6_2.3.0         hms_0.4.2        tools_3.5.1     
 [5] pillar_1.3.1     tibble_2.0.1     Rcpp_1.0.0       crayon_1.3.4    
 [9] pkgconfig_2.0.2  rlang_0.3.1.9000
> proc.time()
    user   system  elapsed 
8625.773 1229.979 7968.922 
